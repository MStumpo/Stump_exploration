<!doctype html>
<!--
  DESCULPA LÁ POR O CSS JS E HTML NO MESMO FICHEIRO MAS É SÓ POR AGORA

  A PARTE Q NÃO FUNCIONA É DO USUÁRIO


  <-->
<html>
  <head>
    <title>Zocial - the actual chat ._.</title>
  <style type="text/css">
    body{
    background-color: #45f442;
    font-family: "Courier New", Courier, monospace; 
    }
    li{
      list-style: none;
    }
    #header{
      margin: 50px;
    }
    #messages{
      width: 40%;
      height: 500px;
      margin-left: 20%;
      list-style: none;
    }
    #send-form{
      position: fixed;
      margin-bottom: 5%;
      margin-left: 20%;
    }
    #message-in{
      background-color: grey;
      border-radius: 10px;
      border-top-right-radius: 0px;
      border-bottom-right-radius: 0px;
      border: solid;
      border-width: 2px;
      border-color: #38bc60;
      height: 20px;
    }
    #massage{
      margin: 5px;
      height: 20px;
    }
    #usr-spot{
      margin-left: 10%;
      margin-bottom: 50px;
      background-color: #38bc60;
      width: 30%;
      border-radius: 10px;
      padding: 20px;
    }
    #user-form{
      margin-top: 20px;
    }
    #current-usr{
      border: none;
      background-color: #38bc60;
      border-radius: 10px;
      margin-top: 15px;
      height: 20px;
    }
    #send-usr{
      background-color: #5d9afc;
      border: none;
      border-radius: 10px;
      height: 40px;
    }
    #send-button{
      border: solid;
      border-bottom-right-radius: 10px;
      border-top-right-radius: 10px;
      background-color: #38bc60;
      border-color: #38bc60;
      height: 26px;
      color: black;
    }

    #usr{
            background-color: #5d9afc;
            border-style: none;
            height: 30px;
            margin-right: 10px;
            border-radius: 10px;
            margin-top: 30px;
    }
    #message-spot{
      margin-right: 20%;
        }
</style>
  </head>
  <body>
    <div id="header">
    <h1>Hey, you actually came!</h1>
    <h3>Thanks! I didn't actually expect you to come here. Oh well, enjoy the room ;D</h3>
  </div>
  <div id="room">
    <div id="usr-spot">So, what's your name?
<form id="user-form" action=""><input id="usr" /><button type="submit" id="send-usr"  >Nice to meet you!</form>
    </div>
    <div id="message-spot">
    <ul id="messages"></ul>
    <div id="send-form">
    <form action="" id="message-formulary">
      <input id="message-in" class="form-control type_msg" autocomplete="off"><button id="send-button">Give your words to the world</button>
    </form>
  </div>
  </div>
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
  $(function () {
    var socket = io.connect();
    var username = $('#usr');
    var users = $('#user-list');

    $('#send-form').hide();
    $('#message-formulary').submit(function(){
          socket.emit('message', $('#message-in').val());
          $('#message-in').val('');
          return false;
        });
    socket.on('message', function(data){
      $('#messages').append($('<li class="massage"><strong>'+ data.user +' :</strong> '+ data.msg + '</li>'));
    });
    function fade(){
    // do whatever you like here
    $(".massage").delay(100).fadeOut(300);
    setTimeout(fade, 5000);
    }
    fade();

    $("#user-form").submit(function(e){
      e.preventDefault();
      socket.emit('new user', $(username).val(), function(data){
      if (data) {
        $('#usr-spot').fadeOut(1500);
        $('#send-form').fadeIn(1500);
      }
      });
      $(username).val('');
    });
  //  socket.on('get users', function(data){
    //  $(users).append('<li>'+socket.user+'</li>');
   // });
  });
    </script>
  </body>
</html>
